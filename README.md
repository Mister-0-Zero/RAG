<div align="center">
  <h1>–õ–æ–∫–∞–ª—å–Ω—ã–π RAG-—Å—Ç–µ–∫ –¥–ª—è –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</h1>
  <p>
    Production-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π RAG-–ø–∞–π–ø–ª–∞–π–Ω, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –∏ –ø–æ–ª–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –Ω–∞–¥ –≤—Å–µ–º–∏ —ç—Ç–∞–ø–∞–º–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö.
  </p>
</div>

![Python Version](https://img.shields.io/badge/python-3.11.9-blue)
![License](https://img.shields.io/badge/License-Apache_2.0-blue.svg)

---

## üìñ –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [üöÄ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞](#-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-–ø–∞–π–ø–ª–∞–π–Ω–∞)
- [üõ†Ô∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [üìã –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è](#-–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
- [‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞](#-—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
- [üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
- [üîí –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞ (ACL)](#-–∫–æ–Ω—Ç—Ä–æ–ª—å-–¥–æ—Å—Ç—É–ø–∞-acl)
- [‚ñ∂Ô∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ](#-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)

## üöÄ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞

–ü—Ä–æ—Ü–µ—Å—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω –∫–∞–∫ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —á–µ—Ç–∫–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —à–∞–≥–æ–≤, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏—Ö –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∞.

1.  **–ê–Ω–∞–ª–∏–∑ –∑–∞–ø—Ä–æ—Å–∞**: –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —è–∑—ã–∫ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ–π –¥–∞–ª—å–Ω–µ–π—à–µ–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏.
2.  **–ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫ (Hybrid Retrieval)**:
    -   **Dense Retrieval**: –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–π –±–ª–∏–∑–æ—Å—Ç–∏ (`SentenceTransformers` + `ChromaDB`).
    -   **Lexical Retrieval**: –ü–æ–∏—Å–∫ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º (BM25) —Å –ø–æ–º–æ—â—å—é `Elasticsearch`.
    -   –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è –∏ –Ω–æ—Ä–º–∞–ª–∏–∑—É—é—Ç—Å—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –µ–¥–∏–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤.
3.  **–ü–µ—Ä–µ—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ (Reranking)**: –ö–∞–Ω–¥–∏–¥–∞—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ `cross-encoder` –º–æ–¥–µ–ª—å –¥–ª—è —Ç–æ—á–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ –∫–∞–∂–¥–æ–≥–æ —á–∞–Ω–∫–∞ –∫ –∑–∞–ø—Ä–æ—Å—É.
4.  **–ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞ (ACL)**: –ü–æ—Å–ª–µ –ø–µ—Ä–µ—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —á–∞–Ω–∫–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
5.  **–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (Context Expansion)**: –î–ª—è –ª—É—á—à–∏—Ö —á–∞–Ω–∫–æ–≤, –ø—Ä–æ—à–µ–¥—à–∏—Ö –ø—Ä–æ–≤–µ—Ä–∫—É ACL, –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ–∏—Å–∫ —Å–æ—Å–µ–¥–Ω–∏—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ–∫—Ä—É–∂–∞—é—â–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç.
6.  **–°–∂–∞—Ç–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (Context Compression)**: –ö–∞–∂–¥—ã–π —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∏–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç —Å–∂–∏–º–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –º–∞–ª–æ–π –ª–æ–∫–∞–ª—å–Ω–æ–π LLM –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è "—à—É–º–∞".
7.  **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ (Answering)**: –°–∂–∞—Ç—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ –æ—Å–Ω–æ–≤–Ω—É—é LLM (–ª–æ–∫–∞–ª—å–Ω—É—é –∏–ª–∏ —á–µ—Ä–µ–∑ API) –¥–ª—è —Å–∏–Ω—Ç–µ–∑–∞ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ —Å—Ç—Ä–æ–≥–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤.

## üõ†Ô∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç –∏–º–µ–µ—Ç –º–æ–¥—É–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –≥–¥–µ –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Å–≤–æ—é —á–∞—Å—Ç—å –ø–∞–π–ø–ª–∞–π–Ω–∞.

-   `ingest.py`: –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ—á–∏—Å—Ç–∫–∞ —Å—ã—Ä—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.
-   `chunking.py`: –†–∞–∑–±–∏–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –Ω–∞ —á–∞–Ω–∫–∏ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö.
-   `embeddings.py`: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ embedding-–º–æ–¥–µ–ª—è–º–∏ (`SentenceTransformers`).
-   `retrieval.py`: –†–µ–∞–ª–∏–∑—É–µ—Ç dense retrieval (—Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫) –ø–æ –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –±–∞–∑–µ.
-   `lexical_es.py`: –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å `Elasticsearch` –¥–ª—è lexical-–ø–æ–∏—Å–∫–∞ (BM25).
-   `hybrid.py`: –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ dense –∏ lexical –ø–æ–∏—Å–∫–∞.
-   `rerank.py`: –õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ —Å –ø–æ–º–æ—â—å—é cross-encoder.
-   `query_decomposer.py`: –î–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è —Å–ª–æ–∂–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –ø–æ–¥–∑–∞–ø—Ä–æ—Å—ã.
-   `acl_rules.py`: –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –ø–∞—Ä—Å–∏–Ω–≥ –ø—Ä–∞–≤–∏–ª –¥–æ—Å—Ç—É–ø–∞ –∏–∑ `acl_rules.yaml`.
-   `users.py`: –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö, –∏—Ö —Ä–æ–ª—è—Ö –∏ –ø–∞—Ä–æ–ª—è—Ö.
-   `auth.py`: –õ–æ–≥–∏–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –ø–∞—Ä–æ–ª—é –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ.
-   `acl_runtime.py`: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª ACL –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –ø–æ–∏—Å–∫–∞ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.
-   `compressor.py`: –û–±–µ—Ä—Ç–∫–∞ –¥–ª—è –º–∞–ª–æ–π LLM, –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –¥–ª—è —Å–∂–∞—Ç–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.
-   `answer.py`: –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.
-   `llm.py`: –ö–ª–∏–µ–Ω—Ç –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å LLM (Groq API, Ollama).
-   `pipeline.py`: –°–±–æ—Ä–∫–∞ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –≤ –µ–¥–∏–Ω—ã–π end-to-end –ø–∞–π–ø–ª–∞–π–Ω.
-   `config.py`: **–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞.**
-   `logger.py`: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ —Ü–≤–µ—Ç–Ω–æ–≥–æ –ª–æ–≥–≥–µ—Ä–∞ –¥–ª—è –≤—Å–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
-   `cli/main.py`: –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º (CLI).

## üìã –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

–ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:

-   **Python**: –í–µ—Ä—Å–∏—è 3.11.9 –∏–ª–∏ –≤—ã—à–µ.
-   **Docker**: –î–ª—è –∑–∞–ø—É—Å–∫–∞ `Elasticsearch`.
-   **Ollama**: –î–ª—è –∑–∞–ø—É—Å–∫–∞ –ª–æ–∫–∞–ª—å–Ω—ã—Ö LLM. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å [–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–∞–π—Ç–∞](https://ollama.com/).

## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1.  **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**
    ```bash
    git clone <your-repo-url>
    cd <repo-name>
    ```

2.  **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ API-–∫–ª—é—á:**
    –ï—Å–ª–∏ –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å LLM —á–µ—Ä–µ–∑ API (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `Groq`), —Å–æ–∑–¥–∞–π—Ç–µ –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ —Ñ–∞–π–ª `.env` –∏ –¥–æ–±–∞–≤—å—Ç–µ –≤ –Ω–µ–≥–æ –≤–∞—à –∫–ª—é—á:
    ```
    MODEL_API_KEY="gsk_YourGroqApiKey"
    ```

3.  **–°–æ–∑–¥–∞–π—Ç–µ –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:**
    ```bash
    python -m venv .venv
    source .venv/bin/activate  # –î–ª—è Linux/macOS
    # –∏–ª–∏
    .venv\Scripts\activate  # –î–ª—è Windows
    ```

4.  **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
    ```bash
    pip install -r requirements.txt
    ```
    > **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è GPU —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã —É—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ –≤–µ—Ä—Å–∏—é `torch`, —Å–æ–≤–º–µ—Å—Ç–∏–º—É—é —Å –≤–∞—à–µ–π –≤–µ—Ä—Å–∏–µ–π CUDA.

5.  **–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–∞–∫–µ—Ç –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–∞–∫ –º–æ–¥—É–ª—å:**
    ```bash
    pip install -e .
    ```

6.  **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å—ã:**
    ```bash
    docker-compose up -d
    ```

7.  **–ó–∞–≥—Ä—É–∑–∏—Ç–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ LLM:**
    –ü—Ä–µ–∂–¥–µ —á–µ–º –∑–∞–≥—Ä—É–∂–∞—Ç—å –º–æ–¥–µ–ª–∏, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä Ollama –∑–∞–ø—É—â–µ–Ω –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ. –í—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å –µ–≥–æ –∫–æ–º–∞–Ω–¥–æ–π `ollama serve`.
    ```bash
    # –ú–æ–¥–µ–ª—å –¥–ª—è —Å–∂–∞—Ç–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
    ollama pull qwen2:1.5b-instruct #–∏–ª–∏ –ª—é–±–∞—è –¥—Ä—É–≥–∞—è –º–æ–¥–µ–ª—å, –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ –Ω–µ–±–æ–ª—å—à–∞—è, —á—Ç–æ–±—ã –∑–∞–ø—Ä–æ—Å—ã –≤—ã–ø–æ–ª–Ω—è–ª–∏—Å—å –∑–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –≤—Ä–µ–º—è

    # –ú–æ–¥–µ–ª—å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤ (–µ—Å–ª–∏ –±—É–¥–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é)
    ollama pull deepseek-coder-v2 #–∏–ª–∏ –ª—é–±–∞—è –¥—Ä—É–≥–∞—è –º–æ–¥–µ–ª—å, –∫–æ—Ç–æ—Ä–∞—è —É –≤–∞—Å –ª–æ–∫–∞–ª—å–Ω–æ –±—É–¥–µ—Ç —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç
    ```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–∞–π–ø–ª–∞–π–Ω–∞ —É–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `rag/config.py` —á–µ—Ä–µ–∑ Pydantic-–º–æ–¥–µ–ª—å `RAGConfig`. **–î–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —ç—Ç–æ—Ç —Ñ–∞–π–ª.**

–ù–∏–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã, –≤–µ—Ä–æ—è—Ç–Ω–æ, –∑–∞—Ö–æ—Ç–∏—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å. –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤ —Ñ–∞–π–ª–µ `rag/config.py`.

### –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—É—Ç–µ–π –∏ —Å–µ—Ä–≤–∏—Å–æ–≤

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |
| --- | --- | --- |
| `data_raw` | –ü—É—Ç—å –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å —Å—ã—Ä—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è –∏–Ω–∂–µ—Å—Ç–∞. | `data/raw` |
| `chroma_db` | –ü—É—Ç—å –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, –≥–¥–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤–µ–∫—Ç–æ—Ä–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö Chroma. | `data/vector_db` |
| `ollama_url` | URL-–∞–¥—Ä–µ—Å –∑–∞–ø—É—â–µ–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ Ollama. | `http://localhost:11435` |
| `device` | –í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ ('cuda' –∏–ª–∏ 'cpu') –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –º–æ–¥–µ–ª–µ–π. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. | `None` (—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏) |

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–¥–µ–ª–µ–π —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –∏ —Ä–µ—Ä–∞–Ω–∫–µ—Ä–æ–≤

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |
| --- | --- | --- |
| `embeddings_model` | –ù–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ SentenceTransformers –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤. | `intfloat/multilingual-e5-base` |
| `rerank_model` | –ù–∞–∑–≤–∞–Ω–∏–µ cross-encoder –º–æ–¥–µ–ª–∏ –¥–ª—è –ø–µ—Ä–µ—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞. | `cross-encoder/ms-marco-MiniLM-L-6-v2` |

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∂–∞—Ç–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |
| --- | --- | --- |
| `model_name_for_compressor` | –ù–∞–∑–≤–∞–Ω–∏–µ –º–∞–ª–æ–π LLM –¥–ª—è —Å–∂–∞—Ç–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ Ollama). | `qwen2.5:3b-instruct` |
| `max_tokens_after_compressed_per_result_` | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø–æ—Å–ª–µ —Å–∂–∞—Ç–∏—è. | `256` |
| `temperature_model_compressor` | –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –¥–ª—è –º–æ–¥–µ–ª–∏ –∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä–∞ (–∫–æ–Ω—Ç—Ä–æ–ª—å —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏). | `0.0` |

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤ LLM

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |
| --- | --- | --- |
| `local_or_API_model` | –í—ã–±–æ—Ä –º–µ–∂–¥—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏ ('local') –∏–ª–∏ API ('API') –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤. | `'API'` |
| `api_model_name` | –ù–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ API (–Ω–∞–ø—Ä–∏–º–µ—Ä, Groq). | `llama-3.3-70b-versatile` |
| `api_temperature` | –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –¥–ª—è API –º–æ–¥–µ–ª–∏, –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É—é—â–∞—è –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å. | `0.5` |
| `api_timeout_s` | –¢–∞–π–º–∞—É—Ç –≤ —Å–µ–∫—É–Ω–¥–∞—Ö –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API. | `5` |
| `api_max_tokens` | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ API –º–æ–¥–µ–ª—å—é. | `2048` |
| `local_model_name` | –ù–∞–∑–≤–∞–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ Ollama. | `deepseek-r1:32b` |
| `local_temperature` | –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏. | `0.5` |
| `local_timeout_s` | –¢–∞–π–º–∞—É—Ç –≤ —Å–µ–∫—É–Ω–¥–∞—Ö –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏. | `30` |
| `local_max_tokens` | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª—å—é. | `2048` |

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø–∞–π–ø–ª–∞–π–Ω–∞

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |
| --- | --- | --- |
| `no_data_response` | –û—Ç–≤–µ—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –∫–æ–≥–¥–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. | `"–î–∞–Ω–Ω—ã—Ö –≤ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π –Ω–µ –Ω–∞—à–ª–æ—Å—å."` |
| `enable_citations` | –í–∫–ª—é—á–∞—Ç—å –ª–∏ —Ü–∏—Ç–∞—Ç—ã (–∏—Å—Ç–æ—á–Ω–∏–∫–∏) –≤ –æ—Ç–≤–µ—Ç. | `False` |
| `min_words_for_decomposition` | –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–≤ –≤ –∑–∞–ø—Ä–æ—Å–µ –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏–∏. | `5` |
| `chunking_mode` | –†–µ–∂–∏–º —á–∞–Ω–∫–∏–Ω–≥–∞: `delimiter` –∏–ª–∏ `size`. | `delimiter` |
| `chunk_delimiters` | –°–ø–∏—Å–æ–∫ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–π –¥–ª—è —á–∞–Ω–∫–∏–Ω–≥–∞. | `['SECTION:']` |
| `chunk_delimiters_are_regex` | –î–µ–ª–∏–º–∏—Ç–µ—Ä—ã —Ç—Ä–∞–∫—Ç—É—é—Ç—Å—è –∫–∞–∫ regex. | `False` |
| `chunk_delimiter_included` | –í–∫–ª—é—á–∞—Ç—å –ª–∏ –¥–µ–ª–∏–º–∏—Ç–µ—Ä –≤ —á–∞–Ω–∫. | `False` |
| `neighbors_forward` | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Å–µ–¥–Ω–∏—Ö —á–∞–Ω–∫–æ–≤ –≤–ø–µ—Ä–µ–¥–∏. | `0` |
| `neighbors_backward` | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Å–µ–¥–Ω–∏—Ö —á–∞–Ω–∫–æ–≤ –ø–æ–∑–∞–¥–∏. | `0` |
| `rerank_top_k` | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –ø–æ—Å–ª–µ —Ä–µ—Ä–∞–Ω–∫–∞. | `3` |
| `vector_filter_builder` | –•—É–∫ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–∞ –ø–æ–∏—Å–∫–∞ (—Å–º. –Ω–∏–∂–µ). | `None` |
| `section_title_boost` | –£—Å–∏–ª–µ–Ω–∏–µ –≤–µ—Å–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞ —Å–µ–∫—Ü–∏–∏ –≤ –ª–µ–∫—Å–∏—á–µ—Å–∫–æ–º –ø–æ–∏—Å–∫–µ. | `3.0` |
| `section_title_in_embeddings` | –î–æ–±–∞–≤–ª—è—Ç—å –ª–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å–µ–∫—Ü–∏–∏ –≤ —Ç–µ–∫—Å—Ç –¥–ª—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤. | `True` |
| `log_mode` | –ë–∏—Ç–æ–≤–∞—è –º–∞—Å–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (—Å–º. –Ω–∏–∂–µ). | `0` |

### –†–µ–∂–∏–º—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (–±–∏—Ç–æ–≤–∞—è –º–∞—Å–∫–∞)

–í—Å–µ–≥–¥–∞ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è: –∑–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –æ—Ç–≤–µ—Ç –º–æ–¥–µ–ª–∏.

| –ó–Ω–∞—á–µ–Ω–∏–µ | –ß—Ç–æ –≤–∫–ª—é—á–∞–µ—Ç |
| --- | --- |
| `0` | –¢–æ–ª—å–∫–æ –∑–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –æ—Ç–≤–µ—Ç –º–æ–¥–µ–ª–∏ |
| `1` | –í–∞—Ä–∏–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–∞ –∏ –≥–∏–ø–æ—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç–≤–µ—Ç |
| `2` | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏, –ø–∞–π–ø–ª–∞–π–Ω–µ, –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏ —Ç–∞–π–º–∏–Ω–≥–∏ |
| `3` | `1 + 2` |
| `4` | –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ—Å–ª–µ rerank, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ –∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä |
| `5` | `1 + 4` |
| `6` | `2 + 4` |
| `7` | `1 + 2 + 4` |

### –£—Å–∏–ª–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ (–≤–∞—Ä–∏–∞—Ü–∏–∏ –∏ –≥–∏–ø–æ—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç–≤–µ—Ç)

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |
| --- | --- | --- |
| `query_variations_count` | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∞—Ä–∏–∞—Ü–∏–π –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞. | `3` |
| `query_use_hypothetical_answer` | –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ª–∏ –≥–∏–ø–æ—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç–≤–µ—Ç –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ –∫–∞–∫ –∑–∞–ø—Ä–æ—Å. | `True` |
| `query_enhancement_mode` | –†–µ–∂–∏–º —É—Å–∏–ª–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞: `single` –∏–ª–∏ `multi`. | `single` |
| `query_enhancer_use_local` | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–∏ –ª–æ–∫–∞–ª—å–Ω—É—é –º–æ–¥–µ–ª—å –¥–ª—è —É—Å–∏–ª–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞. | `True` |
| `query_enhancer_model_name` | –ú–æ–¥–µ–ª—å –¥–ª—è —É—Å–∏–ª–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `local_model_name`). | `None` |
| `query_enhancer_temperature` | –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —É—Å–∏–ª–µ–Ω–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞. | `0.3` |
| `query_enhancer_max_tokens` | –õ–∏–º–∏—Ç —Ç–æ–∫–µ–Ω–æ–≤ –¥–ª—è —É—Å–∏–ª–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞. | `256` |
| `query_enhancer_timeout_s` | –¢–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ —É—Å–∏–ª–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ (—Å–µ–∫). | `30` |

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–æ—Å—Ç—É–ø–∞ (ACL)

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |
| --- | --- | --- |
| `acl` | –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ (ACL). | `False` |
| `default_allow` | –†–∞–∑—Ä–µ—à–∞—Ç—å –ª–∏ –¥–æ—Å—Ç—É–ø –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º –±–µ–∑ —è–≤–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª ACL. | `True` |
| `acl_rules_path` | –ü—É—Ç—å –∫ YAML-—Ñ–∞–π–ª—É —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ ACL. | `rag/acl_rules.yaml` |
| `default_role` | –†–æ–ª—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ–º–∞—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –±–µ–∑ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö —Ä–æ–ª–µ–π. | `"guest"` |

> –î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥—Ä—É–≥–æ–≥–æ API-–ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ (–∫—Ä–æ–º–µ Groq) –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –¥–æ—Ä–∞–±–æ—Ç–∫–∞ –º–æ–¥—É–ª—è `rag/llm.py`.

## üîí –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞ (ACL)

–í –ø—Ä–æ–µ–∫—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Ä–æ–ª–µ–≤–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞ (ACL) –Ω–∞ –æ—Å–Ω–æ–≤–µ —è–≤–Ω–æ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∞–≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º.

### –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã

1.  **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫**: –í `data/raw` –≤—ã —Å–æ–∑–¥–∞–µ—Ç–µ –ø–∞–ø–∫–∏, –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ—Ç–æ—Ä—ã—Ö —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ä–æ–ª—è–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, `admin`, `team_lead`, `developer`) –∏–ª–∏ —É—Ä–æ–≤–Ω–µ–º –¥–æ—Å—Ç—É–ø–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `public`, `private`, `absolutely_private`). –î–æ–∫—É–º–µ–Ω—Ç—ã, –ø–æ–º–µ—â–µ–Ω–Ω—ã–µ –≤ —ç—Ç–∏ –ø–∞–ø–∫–∏, –±—É–¥—É—Ç –∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω—ã —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π —Ä–æ–ª—å—é, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ–π –≤ `rag/acl_rules.yaml`.
2.  **–ü—Ä–∞–≤–∏–ª–∞ –¥–æ—Å—Ç—É–ø–∞**: –í —Ñ–∞–π–ª–µ `rag/acl_rules.yaml` –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫–∏–µ —Ä–æ–ª–∏ –∏–º–µ—é—Ç –¥–æ—Å—Ç—É–ø –∫ –∫–∞–∫–∏–º –ø–∞–ø–∫–∞–º. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≥–∏–±–∫–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ø—Ä–∞–≤–∞.
3.  **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ —Ä–æ–ª–∏**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∏—Ö –ø–∞—Ä–æ–ª–∏ –∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–µ –∏–º —Ä–æ–ª–∏ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `rag/users.py`.
4.  **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ**: –ù–∞ —ç—Ç–∞–ø–µ –∏–Ω–∂–µ—Å—Ç–∞ (`--reindex`) –∫–∞–∂–¥–æ–º—É —á–∞–Ω–∫—É –¥–æ–∫—É–º–µ–Ω—Ç–∞ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç—Å—è –º–µ—Ç–∞–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–æ–ª—è—Ö –¥–æ—Å—Ç—É–ø–∞. –ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–ø—Ä–æ—Å–∞ —Å–∏—Å—Ç–µ–º–∞ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ—Å–ª–µ —ç—Ç–∞–ø–∞ –ø–µ—Ä–µ—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è, –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—è, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∏—Ç –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –∫ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω–æ–º—É –∫–æ–Ω—Ç–µ–Ω—Ç—É.

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

-   **–í–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ**: ACL –º–æ–∂–Ω–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–∫–ª—é—á–∏—Ç—å –≤ `rag/config.py` (`acl: False`).
-   **–ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é**: –§–ª–∞–≥ `default_allow` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –±—É–¥–µ—Ç –ª–∏ –¥–æ—Å—Ç—É–ø –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º –±–µ–∑ —è–≤–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª —Ä–∞–∑—Ä–µ—à–µ–Ω –∏–ª–∏ –∑–∞–ø—Ä–µ—â–µ–Ω.
-   **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: –ü—Ä–∏ –≤–∫–ª—é—á–µ–Ω–Ω–æ–º ACL –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –ø–µ—Ä–µ–¥–∞—Ç—å —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ —Ñ–ª–∞–≥–∏ `--user-role` –∏ `--password`, –∏–Ω–∞—á–µ –µ–º—É –±—É–¥–µ—Ç –≤—ã–¥–∞–Ω–∞
`default_role` –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è –≤ `rag/config.py`.

## ‚ñ∂Ô∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –î–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã

–ü–æ–º–µ—Å—Ç–∏—Ç–µ –≤–∞—à–∏ —Ñ–∞–π–ª—ã (`.pdf`, `.docx`, `.txt`) –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `data/raw`, –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏–≤ –∏—Ö –ø–æ –ø–∞–ø–∫–∞–º –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–æ—Å—Ç—É–ø–∞.

### 2. –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –∏–ª–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏:
```bash
python -m cli.main --reindex
```

### 3. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤

-   **–ë–µ–∑ ACL (–∏–ª–∏ –µ—Å–ª–∏ ACL –æ—Ç–∫–ª—é—á–µ–Ω):**
    ```bash
    rag-cli
    # –∏–ª–∏
    python -m cli.main
    ```

    –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤—ã–≤–æ–¥–∏—Ç—Å—è –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ—Å–ª–µ –∫–æ–º–ø—Ä–µ—Å—Å–∏–∏. –ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –æ—Ç–≤–µ—Ç –º–æ–¥–µ–ª–∏:
    ```bash
    rag-cli --answer
    # –∏–ª–∏
    python -m cli.main --answer
    ```

-   **–° –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π ACL:**
    ```bash
    rag-cli --user-role "–∏–º—è_—Ä–æ–ª–∏" --password "–≤–∞—à_–ø–∞—Ä–æ–ª—å"
    # –∏–ª–∏
    python -m cli.main --user-role "–∏–º—è_—Ä–æ–ª–∏" --password "–≤–∞—à_–ø–∞—Ä–æ–ª—å"
    ```

* –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä–≤–∏—Å ollama –∏ elasticSearch –∑–∞–ø—É—â–µ–Ω—ã.

## üß™ –°—Ç–∞—Ç—É—Å –≤–µ—Ä—Å–∏–π

- **alpha**: —Ä–∞–Ω–Ω—è—è –≤–µ—Ä—Å–∏—è, —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞ —á–∞—Å—Ç–∏—á–Ω–æ, –≤–æ–∑–º–æ–∂–Ω—ã –æ—à–∏–±–∫–∏
- **beta**: —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ alpha, –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã, –Ω–æ –Ω–µ –≤—Å–µ –∫—Ä–∞—è

## üîé –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ñ–∏–ª—å—Ç—Ä –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤—ã–∫–ª—é—á–µ–Ω–∞. –ú–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –≤ `RAGConfig`,
–∫–æ—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∏—Ç —Ñ–∏–ª—å—Ç—Ä –ø–æ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º –∑–∞–ø—Ä–æ—Å–∞:

```python
from rag.config import RAGConfig

def build_vector_filter(where: dict):
    # where –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å language/category –∏ –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
    lang = where.get("language")
    if not lang:
        return None
    if lang == "mixed":
        return {"language": {"$in": ["ru", "en", "mixed"]}}
    return {"$or": [{"language": lang}, {"language": "mixed"}]}

cfg = RAGConfig(vector_filter_builder=build_vector_filter)
```

## ‚ú® –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

–ï—Å–ª–∏ —ç—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –æ–∫–∞–∑–∞–ª—Å—è –ø–æ–ª–µ–∑–Ω—ã–º –¥–ª—è –≤–∞—Å, –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–æ—Å–æ–±–æ–≤ –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å –µ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏–µ:

-   **–ü–æ—Å—Ç–∞–≤—å—Ç–µ –∑–≤–µ–∑–¥—É** –Ω–∞ —ç—Ç–æ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ GitHub. –≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –¥—Ä—É–≥–∏–º —É–∑–Ω–∞—Ç—å –æ –ø—Ä–æ–µ–∫—Ç–µ.
-   **–û—Å—Ç–∞–≤–ª—è–π—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ –∏–¥–µ–∏**. –í–∞—à–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∏ –∑–∞–º–µ—á–∞–Ω–∏—è –æ—á–µ–Ω—å —Ü–µ–Ω–Ω—ã –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è.
-   **–£–≥–æ—Å—Ç–∏—Ç–µ –∞–≤—Ç–æ—Ä–∞ –∫–æ—Ñ–µ**: –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –≤—ã—Ä–∞–∑–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å, –º–æ–∂–µ—Ç–µ –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å –ø—Ä–æ–µ–∫—Ç —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ.

    [–ö—É–ø–∏—Ç—å –∫–æ—Ñ–µ –Ω–∞ Boosty](https://boosty.to/mister_zero/donate)
